<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.44">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mingxin Liu">
<meta name="dcterms.date" content="2023-06-13">

<title>审视荟萃分析中混用生物多样性数量指标的现象及影响 – Mingxin Liu</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Mingxin Liu</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../Research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Publications.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Blogs.html"> 
<span class="menu-text">Blogs</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#荟萃分析越来越多地用于研究生物多样性对栖息地改变的响应" id="toc-荟萃分析越来越多地用于研究生物多样性对栖息地改变的响应" class="nav-link active" data-scroll-target="#荟萃分析越来越多地用于研究生物多样性对栖息地改变的响应">荟萃分析越来越多地用于研究生物多样性对栖息地改变的响应</a></li>
  <li><a href="#审视混用指标的现象及影响" id="toc-审视混用指标的现象及影响" class="nav-link" data-scroll-target="#审视混用指标的现象及影响">审视”混用指标”的现象及影响</a></li>
  <li><a href="#混用指标的现象普遍存在影响不容小觑" id="toc-混用指标的现象普遍存在影响不容小觑" class="nav-link" data-scroll-target="#混用指标的现象普遍存在影响不容小觑">“混用指标”的现象普遍存在、影响不容小觑</a></li>
  <li><a href="#混用指标影响生物多样性变化的推断结果以全球范围的森林恢复为例" id="toc-混用指标影响生物多样性变化的推断结果以全球范围的森林恢复为例" class="nav-link" data-scroll-target="#混用指标影响生物多样性变化的推断结果以全球范围的森林恢复为例">“混用指标”影响生物多样性变化的推断结果——以全球范围的森林恢复为例</a></li>
  <li><a href="#混用指标对推断生物多样性变化造成的影响偏差" id="toc-混用指标对推断生物多样性变化造成的影响偏差" class="nav-link" data-scroll-target="#混用指标对推断生物多样性变化造成的影响偏差">“混用指标”对推断生物多样性变化造成的影响/偏差</a></li>
  <li><a href="#不应该在推断生物多样性变化时混用指标" id="toc-不应该在推断生物多样性变化时混用指标" class="nav-link" data-scroll-target="#不应该在推断生物多样性变化时混用指标">不应该在推断生物多样性变化时”混用指标”</a></li>
  <li><a href="#忠于数量指标的生态学含义" id="toc-忠于数量指标的生态学含义" class="nav-link" data-scroll-target="#忠于数量指标的生态学含义">忠于数量指标的生态学含义</a></li>
  <li><a href="#公开原始数据推动生物多样性研究" id="toc-公开原始数据推动生物多样性研究" class="nav-link" data-scroll-target="#公开原始数据推动生物多样性研究">公开原始数据推动生物多样性研究</a></li>
  <li><a href="#总结" id="toc-总结" class="nav-link" data-scroll-target="#总结">总结</a></li>
  <li><a href="#参考文献" id="toc-参考文献" class="nav-link" data-scroll-target="#参考文献">参考文献</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">审视荟萃分析中混用生物多样性数量指标的现象及影响</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Biodiversity</div>
    <div class="quarto-category">Land-use change</div>
    <div class="quarto-category">Meta-analysis</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Mingxin Liu </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 13, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>This is a re-post from <a href="https://mp.weixin.qq.com/s/1O-sOI0G4_oPSu8S4d6CiA">the original WeChat blog in Mandarin</a>.</p>
</blockquote>
<blockquote class="blockquote">
<p>栖息地改变已经被识别为对生物多样性最大的威胁，掌握生物多样性对栖息地改变的响应规律是制定保护政策、开展保护工作和评估保护成效的重要基础 (IPBES 2019; WWF 2020)。致力于这一研究内容也将助力”昆明—蒙特利尔全球生物多样性框架”和”联合国生态修复十年”等全球性目标的有效达成——遏制进一步丧失，复元生物多样性。</p>
<p>生物多样性的内涵极其丰富，我们通常会利用一些数量指标来量化生物多样性的不同维度。最常用的指标包括物种丰富度 (richness)、物种多度 (abundance)、物种多样性 (diversity)、物种相似性 (similarity) 等。这些指标本质是不同的，只反映生物多样性的特定维度。因此，混用指标”——将不同指标混合使用——用于推断生物多样性对栖息地改变的响应并无生态学意义，甚至可能会逆转结论。</p>
</blockquote>
<section id="荟萃分析越来越多地用于研究生物多样性对栖息地改变的响应" class="level3">
<h3 class="anchored" data-anchor-id="荟萃分析越来越多地用于研究生物多样性对栖息地改变的响应">荟萃分析越来越多地用于研究生物多样性对栖息地改变的响应</h3>
<p>世界范围内大量基于野外的实证研究调查了不同栖息地改变类型对生物多样性的影响。这些栖息地改变类型包括：转变 (conversion)、退化 (degradation)、恢复 (restoration)。得益于这些在世界各地针对不同生态系统、不同物种群落开展的野外调查，科学家能够通过对积累的数据进行荟萃分析 (meta-analysis)，推断生物多样性在更大空间尺度 (如热带区域或全球范围) 对栖息地变化响应的普遍规律以及影响其响应的驱动因素。</p>
<p>确保这类研究结果能够为保护政策的有效评估和适应性调整提供科学证据，其中一个非常重要的前提条件是客观且准确反映生物多样性的响应/变化。</p>
</section>
<section id="审视混用指标的现象及影响" class="level3">
<h3 class="anchored" data-anchor-id="审视混用指标的现象及影响">审视”混用指标”的现象及影响</h3>
<p>然而，“混用指标”这一现象在荟萃分析中不乏出现，甚至在一些重磅研究中也被使用 (Crouzeilles et al.&nbsp;2017; Huang et al.&nbsp;2019; Florencia Miguel et al. 2020)。但是截至目前，尚没有研究揭示”混用指标”的现象到底有多普遍——尤其是在推断生物多样性响应栖息地改变的荟萃分析中。另外一个更重要的问题是：“混用指标”会对量化生物多样性的响应带来什么样的影响？</p>
<p>我们通过系统性的文献搜索，根据研究主题——生物多样性对栖息地改变的响应——筛选出所有目标荟萃分析文献。对所有目标文献，提取以下信息：1) 研究的陆地生态系统类型 (包括海岸、森林、淡水、草地)；2) 栖息地改变的类型 (转变、退化、恢复)；3) 使用的生物多样性数量指标；4) 研究的空间尺度 (区域、全球)；5) 发表年份；6) 出版期刊及其影响因子；7) 文献的年均被引次数。</p>
</section>
<section id="混用指标的现象普遍存在影响不容小觑" class="level3">
<h3 class="anchored" data-anchor-id="混用指标的现象普遍存在影响不容小觑">“混用指标”的现象普遍存在、影响不容小觑</h3>
<p>通过整理分析以上信息，我们梳理出”混用指标”的荟萃分析文献在研究的栖息地改变类型、陆地生态系统、空间尺度的普遍程度。</p>
<p>在筛选出的193篇荟萃分析文献中包含了239个实证案例，“混用指标”出现在44篇文献 (22.7%) 中的61个案例 (25.6%) 中，基本上每5篇文献/案例就有1个”混用指标”并用于推断生物多样性对栖息地改变的响应。这一现象几乎出现在对所有陆地生态系统和栖息地改变类型 (图1) 的荟萃分析文献中，尤其在森林生态系统、退化和恢复等类型中更为明显。</p>
<p>在不同文献中，“混用指标”的数量也存在差异，从混用2个指标到甚至混用超过10个指标 (图1)。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="featured1.png" class="img-fluid figure-img" width="429"></p>
<figcaption>图1 “混用指标”的荟萃分析文献在不同陆地生态系统、不同栖息地改变类型的数量。不同颜色代表荟萃分析文献使用的指标数量。</figcaption>
</figure>
</div>
<p>我们试图通过荟萃分析文献所在出版期刊的影响因子和该文献的年均被引次数，反映”混用指标”的文献具有的影响力。我们发现”混用指标”的文献与不混用指标的文献所在出版期刊的影响因子和该文献的年均被引次数呈现相似分布 (图2)，不仅发表在影响因子较高的期刊，而且具有较多的年均被引次数，表明”混用指标”的文献也具有较大的影响力。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="featured2.png" class="img-fluid figure-img" width="429"></p>
<figcaption>图2 “混用指标”的荟萃分析文献所在出版期刊的影响因子和年均被引次数。每一个三角形或圆圈图标分别代表一篇混用或不混用指标的荟萃分析文献，带有黑色边框的图标表明该文献开展全球尺度研究。仅有标注星号 (*) 的两篇文献测试了混用指标是否影响生物多样性的推断结果。</figcaption>
</figure>
</div>
<p>我们的研究揭示”混用指标”现象在现有研究生物多样性对栖息地改变响应的荟萃分析文献中普遍存在、其影响也不容小觑。</p>
</section>
<section id="混用指标影响生物多样性变化的推断结果以全球范围的森林恢复为例" class="level3">
<h3 class="anchored" data-anchor-id="混用指标影响生物多样性变化的推断结果以全球范围的森林恢复为例">“混用指标”影响生物多样性变化的推断结果——以全球范围的森林恢复为例</h3>
<p>为了回答”混用指标”对量化生物多样性变化的影响，我们选择森林恢复为代表性的栖息地变化类型，收集了不同森林恢复方式生物多样性成效的全球数据集——该数据集来自45个国家，包含了415个物种群落、33,064条物种水平多度数据 (图3)。其中，不同森林恢复方式的对比，包括：恢复人工林与基线原始林、恢复人工林与恢复天然林 (相近林龄)、恢复天然林与基线原始林。</p>
<p>这一全球数据集包含不同物种群落的物种水平多度，因此能够用于计算并对比一系列不同的生物多样性指标。通过对比各指标在不同森林恢复方式与基线森林的response ratio (RR) 来反映生物多样性的恢复成效。这些指标包括：丰富度指标 (observed species richness, rarified species richness)，多度指标 (arithmetic species abundance, geometric mean abundance)，多样性指标 (Shannon index, Simpson index)。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="featured3.png" class="img-fluid figure-img" width="600"></p>
<figcaption>图3 不同森林恢复方式生物多样性成效的全球数据集分布。</figcaption>
</figure>
</div>
<p>此外，我们还通过混合一定比例的不同指标来模拟”混用指标”现象，进一步探究对推断生物多样性变化的影响。第一个模拟指标 (mixture 1) 从备选的物种群落数据中按照1:1的比例随机将常用的5个指标 (observed species richness, rarified species richness, arithmetic species abundance, Shannon index, Simpson index) 进行混合。第二个模拟指标 (mixture 2) 按照1:1的比例随机将使用频次最高的3个指标 observed species richness, arithmetic species abundance, Shannon index) 进行混合。</p>
</section>
<section id="混用指标对推断生物多样性变化造成的影响偏差" class="level3">
<h3 class="anchored" data-anchor-id="混用指标对推断生物多样性变化造成的影响偏差">“混用指标”对推断生物多样性变化造成的影响/偏差</h3>
<p>在三组森林恢复方式的对比中，六个真实的指标 (observed species richness, rarified species richness, arithmetic species abundance, geometric mean abundance, Shannon index, Simpson index) 均反映出不同程度的生物多样性恢复 (图4 a, b, c)。其中，rarified species richness, Shannon index, Simpson index总是比其他指标反映出更积极的生物多样性恢复，且与基线森林的生物多样性水平没有明显差异 (即RR值与0有重叠)。与之相反，observed species richness和geometric mean abundance总是比其他指标反映出更保守的生物多样性恢复。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="featured4.png" class="img-fluid figure-img" width="629"></p>
<figcaption>图4 不同森林恢复方式下各数量指标的恢复成效及其影响因素。(a) 恢复人工林对比基线原始林；(b) 恢复人工林对比恢复天然林 (相近林龄)；(c) 恢复天然林对比基线原始林。生物多样性的恢复成效以物种群落水平的RR反映，RR&gt;0表明该森林恢复方式实现比基线森林更好的生物多样性水平；RR=0表明生物多样性水平相当；RR&lt;0表明该森林恢复方式实现比基线森林更差的生物多样性水平。中间的小方框图标及横线分别代表RR平均值与95%置信区间。(d-f) 橙色代表该变量与生物多样性具有正相关关系，紫色代表负相关关系，加深的颜色表明该关系具有统计显著性。</figcaption>
</figure>
</div>
<p>值得注意的是，两个模拟指标 (mixture 1, mixture 2) 的结果总是与其他指标具有不一样的数值，并介于各自来源指标的中间——该程度取决于它们的来源指标比例是更”积极” (如Shannon index) 还是更”保守” (如observed species richness) 地反映生物多样性的恢复。</p>
<p>上述结果表明，利用不同的指标推断生物多样性恢复的成效不仅会造成定量的数值差异，还可能会对推断生物多样性恢复的成效造成定性差异。</p>
<p>最后，我们的结果也表明，驱动生物多样性恢复的影响因素随着使用的指标不同也可能发生改变 (图4 d, e, f)。</p>
</section>
<section id="不应该在推断生物多样性变化时混用指标" class="level3">
<h3 class="anchored" data-anchor-id="不应该在推断生物多样性变化时混用指标">不应该在推断生物多样性变化时”混用指标”</h3>
<p>通过混合不同数量的不同指标得到的结果，对于推断生物多样性而言，没有生态学含义。例如：Crouzeilles et al.&nbsp;(2017) 混合了超过10个不同的指标得到的结果——“恢复天然林比恢复人工林能够恢复多34-56%的生物多样性”。我们该如何从生态学角度去解读呢？是物种丰富度增加了34-56%，还是物种多度增加了34-56%——恐怕我们都无法给出确信的回答。</p>
<p>针对”混用指标”的现象，我们的建议非常明确：不应该在推断生物多样性变化时混合使用数量指标。此外，一方面，我们还应该谨慎对待已经发表的”混用指标”的文献；另一方面，我们应该忠于指标本身的生态学含义，客观报告不同指标的结果。</p>
</section>
<section id="忠于数量指标的生态学含义" class="level3">
<h3 class="anchored" data-anchor-id="忠于数量指标的生态学含义">忠于数量指标的生态学含义</h3>
<p>解读不同生物多样性指标需要基于它们的生态学含义。丰富度指标反映的是现有物种的数量而不反映现有物种的多度。除非某一个物种完全消失或者刚刚出现，否则这类指标不会发生变化。与之类似，除非物种之间的相对多度发生变化，否则多样性指标也不会发生变化，因此，在使用或解读这两类指标时，应该留意它们对多度变化的不敏感性。</p>
<p>尽管多度指标都携带最基础的信息——即每个物种的个体数量——不同的多度指标仍然存在区别。Arithmetic species abundance (即常用的物种多度指标) 对不同物种赋予相同的权重，因此一个群落中优势物种的多度变化将更为明显的影响该多度指标的变化。而geometric mean abundance通过对不同物种赋予不同的权重避免了上述情况，在生态学角度更为准确地反映了一个群落的多度变化。“地球生命力报告 (Living Planet Report)”所用的Living Planet Index也是基于上述指标的生态学含义进行统计分析 (WWF 2020; Ledger et al. 2023)。</p>
</section>
<section id="公开原始数据推动生物多样性研究" class="level3">
<h3 class="anchored" data-anchor-id="公开原始数据推动生物多样性研究">公开原始数据推动生物多样性研究</h3>
<p>我们在收集生物多样性数据的过程中发现，许多野外实证研究并没有报告详细的调查设计和原始的物种群落调查结果 (即物种水平的多度)。为了推动荟萃分析方法的广泛运用，同时也为了对生物多样性的不同维度进行调查，我们呼吁科学家通过激励机制和意识转变推动原始数据的公开共享，使保护科学更深远的受益。</p>
</section>
<section id="总结" class="level3">
<h3 class="anchored" data-anchor-id="总结">总结</h3>
<ol type="1">
<li><p>荟萃分析研究生物多样性对栖息地改变的响应存在”混用指标”的现象。</p></li>
<li><p>“混用指标”不仅对推断生物多样性的变化造成定量影响，甚至会对推断结论带来定性影响。</p></li>
<li><p>生物多样性数量指标的生态学含义本质不同，不应该在推断生物多样性变化时混合使用。</p></li>
<li><p>公开生物多样性调查的详细设计并分享原始数据，使保护科学更深远受益。</p></li>
</ol>
</section>
<section id="参考文献" class="level3">
<h3 class="anchored" data-anchor-id="参考文献">参考文献</h3>
<ul>
<li>Crouzeilles, R., Ferreira, M.S., Chazdon, R.L., Lindenmayer, D.B., Sansevero, J.B.B., Monteiro, L., Iribarrem, A., Latawiec, A.E. &amp; Strassburg, B.B.N. (2017). Ecological restoration success is higher for natural regeneration than for active restoration in tropical forests. Science Advances, 3, e1701345.</li>
<li>Florencia Miguel, M., Scott Butterfield, H. &amp; Lortie, C.J. (2020). A meta-analysis contrasting active versus passive restoration practices in dryland agricultural ecosystems. PeerJ, 8, e10428.</li>
<li>Huang, C., Zhou, Z., Peng, C., Teng, M. &amp; Wang, P. (2019). How is biodiversity changing in response to ecological restoration in terrestrial ecosystems? A meta-analysis in China. Science of The Total Environment, 650, 1–9.</li>
<li>IPBES. (2019). Summary for policymakers of the global assessment report on biodiversity and ecosystem services of the Intergovernmental Science-Policy Platform on Biodiversity and Ecosystem Services. S. Díaz, J. Settele, E. S. Brondízio E.S., H. T. Ngo, M. Guèze, J. Aga.</li>
<li>Ledger, S.E.H., Loh, J., Almond, R., Böhm, M., Clements, C.F., Currie, J., Deinet, S., Galewski, T., Grooten, M., Jenkins, M., Marconi, V., Painter, B., Scott-Gatty, K., Young, L., Hoffmann, M., Freeman, R. &amp; McRae, L. (2023). Past, present, and future of the Living Planet Index. npj biodivers, 2, 1–13.</li>
<li>WWF. (2020). Living Planet Report 2020 - Bending the curve of biodiversity loss. Almond, R.E.A., Grooten M. and Petersen, T. (Eds). WWF, Gland, Switzerland.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>